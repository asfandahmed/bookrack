function notify(){$.ajax({type:"GET",url:"http://localhost/bookrack/index.php/check_notification",dataType:"json",success:function(o){o.success&&($("#top-navbar .navitems li:nth-child(2) a").append('<span class="glyphicon glyphicon-exclamation-sign"> </span>'),$("#top-navbar .navitems li:nth-child(2) a").attr("title","You have new notifications."),clearTimeout(notify_timer))},error:function(o,e,t){console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}})}function view_comments(){}function add_books(){$("#book-form").submit(function(o){$.ajax({type:"POST",url:$("#book-form").attr("action"),data:$("#book-form").serialize(),dataType:"json",encode:!0,success:function(o){console.log(o),humane.log("Book Added")},error:function(o,e,t){humane.log("Add a book name"),console.log="Error: "+t,console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),o.unbind()})}function uploadProfileImage(){var o={target:"#output",beforeSubmit:beforeSubmit,resetForm:!0,dataType:"json",success:successProfileImage};$(document).on("submit","#profile_image_form",function(){return $(this).ajaxSubmit(o),!1})}function successProfileImage(o){var e='<img class="no-resposive-image" src="'+o.path+'" alt="Profile picture" title="">';$("#loading-img").css("display","none"),$("input#submit-btn").css("display","block"),"success"==o.error&&($("#profilePicture").attr("src",o.path),$("#pictureStatus").html(o.msg)),$("#output").html(e)}function beforeSubmit(){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return $("#output").html("Please upgrade your browser, because your current browser lacks some new features we need!"),!1;if(!$("#imageInput").val())return $("#output").html("Are you kidding me?"),!1;var o=$("#imageInput")[0].files[0].size,e=$("#imageInput")[0].files[0].type;switch(e){case"image/png":case"image/gif":case"image/jpeg":case"image/pjpeg":break;default:return $("#output").html("<b>"+e+"</b> Unsupported file type!"),!1}return o>2048576?($("#output").html("<b>"+o+"</b> Too big Image file! <br />Please reduce the size of your photo using an image editor."),!1):($("#submit-btn").hide(),$("#loading-img").show(),void $("#output").html(""))}function postStatus(){$("#statusForm").submit(function(o){$.ajax({type:"POST",url:$("#statusForm").attr("action"),data:$("#statusForm").serialize(),dataType:"json",encode:!0,success:function(o){after_status_post(o)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()})}function after_status_post(o){1==o.success&&$("#statusForm").find("input[name=status]").val(""),humane.log(o.error)}function search_submit(){$("#search-form").submit()}function delete_node(o){if(!window.confirm("Are you sure you want to delete this?"))return!1;var e="#delete_"+o;$.ajax({url:$(e).attr("url"),method:"POST",data:{node_id:o},dataType:"json",encode:!0,success:function(o){alert(o.msg),location.reload()},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}})}function postComment(o){var e=$(o)[0];$(e).bind("submit",function(o){o||(o=window.event),$.ajax({type:"POST",url:$(e).attr("action"),data:$(e).serialize(),dataType:"json",encode:!0,cache:!1,success:function(o){if(o.success){var t=createComment(o);$(e).parents().eq(1).before(t).fadeIn(2e3),$(e).find("input[name=comment]").val("")}else humane.log(o.error)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()})}function after_message_sent(o){var e=$(o).attr("action"),t=$(o+' input[name="email"]').val();e=e.substring(0,e.lastIndexOf("/")+1),e=e.concat("show/"),e+=encodeURIComponent(t),console.log(e),$(".modal-dialog").load(e,function(o,e,t){if("error"==e){var r="Sorry but there was an error: ";$("#contentModal").html(r+t.status+" "+t.statusText)}else{var n=$("#conversation").get(0);n.scrollTop=n.scrollHeight}})}function displayComment(o){createComment(o)}function createComment(o){var e='<div class="row"><div class="col-xs-3 col-sm-3 col-md-3 col-lg-3"><img style="width:50px;height:43px;" title="'+o.comment.fullname+'" alt="'+o.comment.fullname+'" src="'+o.comment.image+'"></div>';return e+='<div class="col-xs-9 col-sm-9 col-md-9 col-lg-9">'+o.comment.commentText+"</div></div>"}function getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(savePosition,showError)}function savePosition(o){var e="http://localhost/bookrack/index.php/users/save_lat_lon";$.post(e,{lat:o.coords.latitude,lon:o.coords.longitude},function(o,e){switch(e){case"success":location.reload();break;case"error":humane.log("Your request can't be completed. Try later.");break;case"timeout":humane.log("Request time out. Try later.");break;default:humane.log("Unknown error occured please submit your issue at support.")}})}function showError(o){switch(o.code){case o.PERMISSION_DENIED:humane.log("user did not share geolocation data");break;case o.POSITION_UNAVAILABLE:humane.log("could not detect current position");break;case o.TIMEOUT:humane.log("retrieving position timed out");break;default:humane.log("unknown error")}}var notify_timer=0;$(document).ready(function(){notify(),notify_timer=setTimeout(notify,6e4),$(".comment_bar").hide(),$("#profile_pic_box").capslide({caption_color:"#bfedfa",caption_bgcolor:"#000",overlay_bgcolor:"#000",border:"",showcaption:!1}),$(".ic_container").capslide({caption_color:"#bfedfa",caption_bgcolor:"#000",overlay_bgcolor:"#000",border:"10px solid #e8eced",showcaption:!0});var o=$("#search-form").attr("action");o=o.substring(0,o.lastIndexOf("/")+1),o=o.concat("get_suggested_searches"),$("input[name=search]").autocomplete({delay:1e3,minLength:1,source:o}),$("#load_messages").on("click",function(o){o.preventDefault();var e=$(this).attr("href");$("#contentModal").load(e,function(o,e,t){if("error"==e){var r="Sorry but there was an error: ";$("#contentModal").html(r+t.status+" "+t.statusText)}})}),$(document).on("click","#load_message_compose",function(){var o=$(this).attr("url");$(".modal-dialog").load(o,function(o,e,t){if("error"==e){var r="Sorry but there was an error: ";$("#contentModal").html(r+t.status+" "+t.statusText)}})}),$(document).on("click","#back_messages",function(){var o=$(this).attr("url");$(".modal-dialog").load(o,function(o,e,t){if("error"==e){var r="Sorry but there was an error: ";$("#contentModal").html(r+t.status+" "+t.statusText)}})}),$(document).on("click",".show-messages",function(){var o=$(this).attr("data-url");$(".modal-dialog").load(o,function(o,e,t){if("error"==e){var r="Sorry but there was an error: ";$("#contentModal").html(r+t.status+" "+t.statusText)}else{var n=$("#conversation").get(0);n.scrollTop=n.scrollHeight}})}),$("#upload_image_loader").on("click",function(o){o.preventDefault();var e=$(this).attr("href");$("#contentModal").load(e,function(o,e,t){if("error"==e){var r="Sorry but there was an error: ";$("#contentModal").html(r+t.status+" "+t.statusText)}})})}),$(".btnBorrow").click(function(o){var e=$(this).attr("href"),t={bookId:$(this).attr("bookid"),to:$(this).attr("to"),bookTitle:$(".btnBorrow").attr("booktitle")};$.ajax({type:"POST",url:e,data:t,dataType:"json",success:function(o){console.log(o)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault()}),$("#followBtn").click(function(o){var e=$("#followBtn").attr("usertobefollowed"),t=$("#followBtn").attr("href");newurl=t.substring(0,t.lastIndexOf("/")+1),newurl=t.concat("unfollow");var r='<a class="btn btn-xs btn-default" usertobeunfollowed="'+e+'" id="unfollowBtn" href="'+newurl+'"><span class="glyphicon glyphicon-ban-circle"></span> Unfollow</a>';$.ajax({type:"POST",url:t,data:{usertobefollowed:e},dataType:"json",success:function(o){$("#followBtn").replaceWith(r),humane.log("You followed a user"),console.log(o)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),o.unbind()}),$(".SuggfollowBtn").click(function(o){var e=$(this).data("user"),t=$(this).attr("href");$.ajax({type:"POST",url:t,data:{usertobefollowed:e},dataType:"json",success:function(o){$("#row-"+e).fadeOut(),humane.log("You followed a user"),console.log(o)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault()}),$(document).on("click",".comment-button",function(){var o=$(this).attr("data-post"),e="#commentbar_"+o;$(e).toggle("slow")}),$(".commentsloader").on("click",function(o){o.preventDefault();var e=$(this).attr("href");$(this).parent().load(e,function(o,e,t){if("error"==e){var r="Sorry but there was an error: ";$("#contentModal").html(r+t.status+" "+t.statusText)}})}),$(document).on("click",".like-button",function(o){var e=$(this).attr("href"),t=e.replace("like","unlike"),r='<a href="'+t+'" class="unlike-button">Unlike</a>',n=$(this);$.ajax({type:"GET",url:e,dataType:"json",success:function(){$(n).replaceWith(r)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()}),$(document).on("click",".unlike-button",function(o){var e=$(this).attr("href"),t=e.replace("unlike","like"),r='<a href="'+t+'" class="like-button">Like</a>',n=$(this);$.ajax({type:"GET",url:e,dataType:"json",success:function(){$(n).replaceWith(r)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()}),$(document).on("submit","#message-form",function(o){$.ajax({type:"POST",url:$("#message-form").attr("action"),data:$("#message-form").serialize(),dataType:"json",encode:!0,cache:!1,success:function(o){o.success?after_message_sent("#message-form"):humane.log(o.error)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()}),$(".btn-hide").click(function(){}),$(document).on("click",".btn-remove",function(o){var e=$(this).attr("data-postId"),t=$(this).attr("data-url");$.ajax({type:"POST",url:t,data:{statusId:e},dataType:"json",encode:!0,success:function(o){console.log(o),humane.log(o.error)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)},complete:function(){$("#post_"+e).fadeOut()}}),o.preventDefault(),o.unbind()}),$(".btn-wishlist").click(function(o){var e=$(this).attr("href"),t=$(this),r=t.data("post");$.ajax({type:"POST",url:e,data:{statusId:r},dataType:"json",encode:!0,success:function(o){console.log(o)},error:function(o,e,t){humane.log("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)},complete:function(){}}),o.preventDefault(),o.unbind()}),$(document).on("click",".btn-approve-borrow-request",function(o){var e=$(this);$.ajax({type:"GET",url:$(this).attr("href"),dataType:"json",success:function(){$(e).fadeOut()},error:function(o,e,t){alert("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()}),$(document).on("click",".btn-ignore-borrow-request",function(o){var e=$(this);$.ajax({type:"GET",url:$(this).attr("href"),dataType:"json",success:function(){$(e).fadeOut()},error:function(o,e,t){alert("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()}),$(document).on("click",".btn-cancel-borrow-request",function(o){var e=$(this);$.ajax({type:"GET",url:$(this).attr("href"),dataType:"json",success:function(){$(e).fadeOut()},error:function(o,e,t){alert("Sorry, there was a problem!"),console.log("Error: "+t),console.log("Status: "+e),console.dir(o)}}),o.preventDefault(),$(this).unbind()});